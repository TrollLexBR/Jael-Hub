local Library = {}

-- Services
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Variáveis globais
local DrawingObjects = {}
local ActiveWindow = nil
local Dragging = false
local DragStart = nil
local StartPos = nil

-- Função para criar texto
local function CreateText(properties)
    local text = Drawing.new("Text")
    text.Text = properties.Text or ""
    text.Color = properties.Color or Color3.new(1, 1, 1)
    text.Size = properties.Size or 13
    text.Position = properties.Position or Vector2.new(0, 0)
    text.Visible = properties.Visible or true
    text.Center = properties.Center or false
    text.Outline = properties.Outline or false
    text.OutlineColor = properties.OutlineColor or Color3.new(0, 0, 0)
    text.Font = properties.Font or 2
    
    return text
end

function Library:ToggleUI()
    if ActiveWindow then
        ActiveWindow.Visible = not ActiveWindow.Visible
        for _, obj in pairs(DrawingObjects) do
            if obj.Visible ~= nil then
                obj.Visible = ActiveWindow.Visible
            end
        end
    end
end

function Library:NewWindow(hubName, gameName, version, discord)
    -- Limpar objetos anteriores
    for _, obj in pairs(DrawingObjects) do
        obj:Remove()
    end
    DrawingObjects = {}

    hubName = hubName or "Jael Library"
    gameName = gameName or "Baseplate"
    version = version or "v1.0"
    discord = discord or "discord/00000"

    local GUI = {}
    local windowPosition = Vector2.new(200, 100)
    local windowSize = Vector2.new(683, 464)
    
    -- Main Window Frame
    GUI.MainFrame = Drawing.new("Square")
    GUI.MainFrame.Filled = true
    GUI.MainFrame.Color = Color3.fromRGB(26, 26, 26)
    GUI.MainFrame.Size = windowSize
    GUI.MainFrame.Position = windowPosition
    GUI.MainFrame.Visible = true
    table.insert(DrawingObjects, GUI.MainFrame)

    -- SideBar
    GUI.SideBar = Drawing.new("Square")
    GUI.SideBar.Filled = true
    GUI.SideBar.Color = Color3.fromRGB(36, 36, 36)
    GUI.SideBar.Size = Vector2.new(189, 464)
    GUI.SideBar.Position = windowPosition
    GUI.SideBar.Visible = true
    table.insert(DrawingObjects, GUI.SideBar)

    -- Hub Name Label
    GUI.HubNameLabel = CreateText({
        Text = hubName,
        Color = Color3.fromRGB(255, 255, 255),
        Size = 20,
        Position = windowPosition + Vector2.new(15, 15),
        Visible = true
    })
    table.insert(DrawingObjects, GUI.HubNameLabel)

    -- Game Name Label
    GUI.GameNameLabel = CreateText({
        Text = gameName,
        Color = Color3.fromRGB(102, 5, 172),
        Size = 16,
        Position = windowPosition + Vector2.new(15, 45),
        Visible = true
    })
    table.insert(DrawingObjects, GUI.GameNameLabel)

    -- Top Bar
    GUI.TopBar = Drawing.new("Square")
    GUI.TopBar.Filled = true
    GUI.TopBar.Color = Color3.fromRGB(36, 36, 36)
    GUI.TopBar.Size = Vector2.new(490, 41)
    GUI.TopBar.Position = windowPosition + Vector2.new(189, 0)
    GUI.TopBar.Visible = true
    table.insert(DrawingObjects, GUI.TopBar)

    -- Discord Label
    GUI.DiscordLabel = CreateText({
        Text = discord,
        Color = Color3.fromRGB(120, 138, 255),
        Size = 14,
        Position = windowPosition + Vector2.new(189 + 350, 15),
        Visible = true
    })
    table.insert(DrawingObjects, GUI.DiscordLabel)

    -- Version Label
    GUI.VersionLabel = CreateText({
        Text = version,
        Color = Color3.fromRGB(255, 255, 255),
        Size = 12,
        Position = windowPosition + Vector2.new(189 + 400, 15),
        Visible = true
    })
    table.insert(DrawingObjects, GUI.VersionLabel)

    -- Home Button
    GUI.HomeButton = Drawing.new("Square")
    GUI.HomeButton.Filled = true
    GUI.HomeButton.Color = Color3.fromRGB(102, 5, 172)
    GUI.HomeButton.Size = Vector2.new(135, 35)
    GUI.HomeButton.Position = windowPosition + Vector2.new(27, 100)
    GUI.HomeButton.Visible = true
    table.insert(DrawingObjects, GUI.HomeButton)

    GUI.HomeButtonText = CreateText({
        Text = "Home",
        Color = Color3.fromRGB(255, 255, 255),
        Size = 14,
        Position = windowPosition + Vector2.new(40, 108),
        Visible = true
    })
    table.insert(DrawingObjects, GUI.HomeButtonText)

    -- Home Frame
    GUI.HomeFrame = Drawing.new("Square")
    GUI.HomeFrame.Filled = true
    GUI.HomeFrame.Color = Color3.fromRGB(36, 36, 36)
    GUI.HomeFrame.Size = Vector2.new(490, 419)
    GUI.HomeFrame.Position = windowPosition + Vector2.new(189, 41)
    GUI.HomeFrame.Visible = true
    table.insert(DrawingObjects, GUI.HomeFrame)

    -- Welcome Label
    GUI.WelcomeLabel = CreateText({
        Text = "Welcome, "..LocalPlayer.DisplayName.."!",
        Color = Color3.fromRGB(255, 255, 255),
        Size = 18,
        Position = windowPosition + Vector2.new(200, 60),
        Visible = true
    })
    table.insert(DrawingObjects, GUI.WelcomeLabel)

    -- Bar separator
    GUI.Bar = Drawing.new("Square")
    GUI.Bar.Filled = true
    GUI.Bar.Color = Color3.fromRGB(102, 5, 172)
    GUI.Bar.Size = Vector2.new(477, 1)
    GUI.Bar.Position = windowPosition + Vector2.new(195, 90)
    GUI.Bar.Visible = true
    table.insert(DrawingObjects, GUI.Bar)

    -- Features Frame
    GUI.FeaturesFrame = Drawing.new("Square")
    GUI.FeaturesFrame.Filled = true
    GUI.FeaturesFrame.Color = Color3.fromRGB(41, 41, 41)
    GUI.FeaturesFrame.Size = Vector2.new(477, 353)
    GUI.FeaturesFrame.Position = windowPosition + Vector2.new(195, 100)
    GUI.FeaturesFrame.Visible = true
    table.insert(DrawingObjects, GUI.FeaturesFrame)

    -- Sistema de drag global
    local function updateDrag(input)
        if Dragging then
            local delta = input.Position - DragStart
            windowPosition = StartPos + delta
            
            -- Atualizar todas as posições
            GUI.MainFrame.Position = windowPosition
            GUI.SideBar.Position = windowPosition
            GUI.HubNameLabel.Position = windowPosition + Vector2.new(15, 15)
            GUI.GameNameLabel.Position = windowPosition + Vector2.new(15, 45)
            GUI.TopBar.Position = windowPosition + Vector2.new(189, 0)
            GUI.DiscordLabel.Position = windowPosition + Vector2.new(189 + 350, 15)
            GUI.VersionLabel.Position = windowPosition + Vector2.new(189 + 400, 15)
            GUI.HomeButton.Position = windowPosition + Vector2.new(27, 100)
            GUI.HomeButtonText.Position = windowPosition + Vector2.new(40, 108)
            GUI.HomeFrame.Position = windowPosition + Vector2.new(189, 41)
            GUI.WelcomeLabel.Position = windowPosition + Vector2.new(200, 60)
            GUI.Bar.Position = windowPosition + Vector2.new(195, 90)
            GUI.FeaturesFrame.Position = windowPosition + Vector2.new(195, 100)
        end
    end

    -- Input handling para drag
    local dragConnection1 = UserInputService.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            local mousePos = input.Position
            local topBarPos = GUI.TopBar.Position
            local topBarSize = GUI.TopBar.Size
            
            if mousePos.X >= topBarPos.X and mousePos.X <= topBarPos.X + topBarSize.X and
               mousePos.Y >= topBarPos.Y and mousePos.Y <= topBarPos.Y + topBarSize.Y then
                Dragging = true
                DragStart = input.Position
                StartPos = windowPosition
            end
        end
    end)

    local dragConnection2 = UserInputService.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            updateDrag(input)
        end
    end)

    local dragConnection3 = UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            Dragging = false
        end
    end)

    ActiveWindow = GUI.MainFrame

    function GUI:FeatureNewGame(gameName)
        gameName = gameName or "- New Game"
        local NewGame = {}
        
        NewGame.Text = CreateText({
            Text = gameName,
            Color = Color3.fromRGB(255, 255, 255),
            Size = 16,
            Position = GUI.FeaturesFrame.Position + Vector2.new(10, 10),
            Visible = true
        })
        table.insert(DrawingObjects, NewGame.Text)
        
        return NewGame
    end

    function GUI:FeatureNewFeature(featureLabel)
        featureLabel = featureLabel or "- New Feature"
        local feature = {}
        
        feature.Text = CreateText({
            Text = featureLabel,
            Color = Color3.fromRGB(255, 255, 255),
            Size = 14,
            Position = GUI.FeaturesFrame.Position + Vector2.new(20, 30),
            Visible = true
        })
        table.insert(DrawingObjects, feature.Text)
        
        return feature
    end

    function GUI:NewTab(tabName)
        tabName = tabName or "New Tab"
        local Tab = {}
        Tab.DrawingObjects = {}
        Tab.Elements = {}
        Tab.CurrentY = 10
        
        -- Criar botão da tab
        Tab.Button = Drawing.new("Square")
        Tab.Button.Filled = true
        Tab.Button.Color = Color3.fromRGB(35, 35, 35)
        Tab.Button.Size = Vector2.new(135, 35)
        Tab.Button.Position = windowPosition + Vector2.new(27, 150 + (#Tab.Elements * 40))
        Tab.Button.Visible = true
        table.insert(DrawingObjects, Tab.Button)
        table.insert(Tab.DrawingObjects, Tab.Button)

        Tab.ButtonText = CreateText({
            Text = tabName,
            Color = Color3.fromRGB(117, 117, 117),
            Size = 14,
            Position = windowPosition + Vector2.new(40, 158 + (#Tab.Elements * 40)),
            Visible = true
        })
        table.insert(DrawingObjects, Tab.ButtonText)
        table.insert(Tab.DrawingObjects, Tab.ButtonText)

        -- Tab Frame
        Tab.Frame = Drawing.new("Square")
        Tab.Frame.Filled = true
        Tab.Frame.Color = Color3.fromRGB(36, 36, 36)
        Tab.Frame.Size = Vector2.new(490, 419)
        Tab.Frame.Position = windowPosition + Vector2.new(189, 41)
        Tab.Frame.Visible = false
        table.insert(DrawingObjects, Tab.Frame)
        table.insert(Tab.DrawingObjects, Tab.Frame)

        -- Função para verificar clique em área
        local function isPointInRectangle(point, rectPos, rectSize)
            return point.X >= rectPos.X and point.X <= rectPos.X + rectSize.X and
                   point.Y >= rectPos.Y and point.Y <= rectPos.Y + rectSize.Y
        end

        -- Sistema de clique para o botão da tab
        local tabClickConnection = UserInputService.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 and ActiveWindow.Visible then
                local mousePos = input.Position
                if isPointInRectangle(mousePos, Tab.Button.Position, Tab.Button.Size) then
                    -- Esconder todas as tabs
                    for _, otherTab in pairs(GUI.Tabs or {}) do
                        otherTab.Frame.Visible = false
                        otherTab.Button.Color = Color3.fromRGB(35, 35, 35)
                        otherTab.ButtonText.Color = Color3.fromRGB(117, 117, 117)
                    end
                    
                    -- Mostrar esta tab
                    Tab.Frame.Visible = true
                    Tab.Button.Color = Color3.fromRGB(102, 5, 172)
                    Tab.ButtonText.Color = Color3.fromRGB(255, 255, 255)
                    
                    -- Mostrar elementos desta tab
                    for _, element in pairs(Tab.Elements) do
                        if element.SetVisible then
                            element:SetVisible(true)
                        end
                    end
                end
            end
        end)

        table.insert(Tab.DrawingObjects, {Disconnect = function() tabClickConnection:Disconnect() end})

        function Tab:NewLabel(label)
            label = label or "New Label"
            local Label = {}
            
            local labelY = self.CurrentY
            self.CurrentY = self.CurrentY + 25
            
            Label.Text = CreateText({
                Text = label,
                Color = Color3.fromRGB(255, 255, 255),
                Size = 14,
                Position = self.Frame.Position + Vector2.new(10, labelY),
                Visible = self.Frame.Visible
            })
            table.insert(DrawingObjects, Label.Text)
            table.insert(self.DrawingObjects, Label.Text)
            
            function Label:SetVisible(visible)
                self.Text.Visible = visible
            end
            
            table.insert(self.Elements, Label)
            
            return Label
        end

        function Tab:NewButton(label, callback)
            label = label or "New Button"
            callback = callback or function() end
            
            local Button = {}
            local buttonSize = Vector2.new(470, 35)
            local buttonY = self.CurrentY
            self.CurrentY = self.CurrentY + buttonSize.Y + 5
            
            -- Background do botão
            Button.Background = Drawing.new("Square")
            Button.Background.Filled = true
            Button.Background.Color = Color3.fromRGB(41, 41, 41)
            Button.Background.Size = buttonSize
            Button.Background.Position = self.Frame.Position + Vector2.new(10, buttonY)
            Button.Background.Visible = self.Frame.Visible
            table.insert(DrawingObjects, Button.Background)
            table.insert(self.DrawingObjects, Button.Background)

            -- Texto do botão
            Button.Text = CreateText({
                Text = label,
                Color = Color3.fromRGB(255, 255, 255),
                Size = 14,
                Position = self.Frame.Position + Vector2.new(20, buttonY + 10),
                Visible = self.Frame.Visible
            })
            table.insert(DrawingObjects, Button.Text)
            table.insert(self.DrawingObjects, Button.Text)

            -- Evento de clique
            local buttonClickConnection = UserInputService.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 and self.Frame.Visible then
                    local mousePos = input.Position
                    if isPointInRectangle(mousePos, Button.Background.Position, Button.Background.Size) then
                        callback()
                        -- Feedback visual
                        local originalColor = Button.Background.Color
                        Button.Background.Color = Color3.fromRGB(102, 5, 172)
                        delay(0.1, function()
                            Button.Background.Color = originalColor
                        end)
                    end
                end
            end)

            function Button:SetVisible(visible)
                self.Background.Visible = visible
                self.Text.Visible = visible
            end

            table.insert(self.DrawingObjects, {Disconnect = function() buttonClickConnection:Disconnect() end})
            table.insert(self.Elements, Button)
            
            return Button
        end

        function Tab:NewSlider(label, min, max, default, callback)
            label = label or "New Slider"
            min = min or 0
            max = max or 100
            default = default or 50
            callback = callback or function() end

            local Slider = {
                Value = default,
                Min = min,
                Max = max
            }

            local sliderSize = Vector2.new(470, 50)
            local sliderY = self.CurrentY
            self.CurrentY = self.CurrentY + sliderSize.Y + 5
            
            -- Background do slider
            Slider.Background = Drawing.new("Square")
            Slider.Background.Filled = true
            Slider.Background.Color = Color3.fromRGB(41, 41, 41)
            Slider.Background.Size = sliderSize
            Slider.Background.Position = self.Frame.Position + Vector2.new(10, sliderY)
            Slider.Background.Visible = self.Frame.Visible
            table.insert(DrawingObjects, Slider.Background)
            table.insert(self.DrawingObjects, Slider.Background)

            -- Label do slider
            Slider.Label = CreateText({
                Text = label,
                Color = Color3.fromRGB(255, 255, 255),
                Size = 14,
                Position = self.Frame.Position + Vector2.new(20, sliderY + 5),
                Visible = self.Frame.Visible
            })
            table.insert(DrawingObjects, Slider.Label)
            table.insert(self.DrawingObjects, Slider.Label)

            -- Valor atual
            Slider.ValueText = CreateText({
                Text = tostring(default),
                Color = Color3.fromRGB(255, 255, 255),
                Size = 14,
                Position = self.Frame.Position + Vector2.new(sliderSize.X - 30, sliderY + 5),
                Visible = self.Frame.Visible
            })
            table.insert(DrawingObjects, Slider.ValueText)
            table.insert(self.DrawingObjects, Slider.ValueText)

            -- Track do slider
            Slider.Track = Drawing.new("Square")
            Slider.Track.Filled = true
            Slider.Track.Color = Color3.fromRGB(36, 36, 36)
            Slider.Track.Size = Vector2.new(sliderSize.X - 40, 15)
            Slider.Track.Position = self.Frame.Position + Vector2.new(20, sliderY + 25)
            Slider.Track.Visible = self.Frame.Visible
            table.insert(DrawingObjects, Slider.Track)
            table.insert(self.DrawingObjects, Slider.Track)

            -- Progresso do slider
            local initialProgress = ((default - min) / (max - min)) * (sliderSize.X - 40)
            Slider.Progress = Drawing.new("Square")
            Slider.Progress.Filled = true
            Slider.Progress.Color = Color3.fromRGB(102, 5, 172)
            Slider.Progress.Size = Vector2.new(initialProgress, 15)
            Slider.Progress.Position = self.Frame.Position + Vector2.new(20, sliderY + 25)
            Slider.Progress.Visible = self.Frame.Visible
            table.insert(DrawingObjects, Slider.Progress)
            table.insert(self.DrawingObjects, Slider.Progress)

            -- Função para atualizar o slider
            function Slider:SetValue(value)
                value = math.clamp(value, min, max)
                self.Value = value
                local progressWidth = ((value - min) / (max - min)) * (sliderSize.X - 40)
                self.Progress.Size = Vector2.new(progressWidth, 15)
                self.ValueText.Text = tostring(math.floor(value))
                callback(value)
            end

            -- Interação
            local sliderDragging = false
            
            local sliderClickConnection1 = UserInputService.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 and self.Frame.Visible then
                    local mousePos = input.Position
                    if isPointInRectangle(mousePos, Slider.Track.Position, Slider.Track.Size) then
                        sliderDragging = true
                        local relativeX = (mousePos.X - Slider.Track.Position.X) / Slider.Track.Size.X
                        local value = min + ((max - min) * math.clamp(relativeX, 0, 1))
                        Slider:SetValue(value)
                    end
                end
            end)

            local sliderClickConnection2 = UserInputService.InputChanged:Connect(function(input)
                if sliderDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    local mousePos = input.Position
                    local relativeX = (mousePos.X - Slider.Track.Position.X) / Slider.Track.Size.X
                    local value = min + ((max - min) * math.clamp(relativeX, 0, 1))
                    Slider:SetValue(math.floor(value))
                end
            end)

            local sliderClickConnection3 = UserInputService.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    sliderDragging = false
                end
            end)

            function Slider:SetVisible(visible)
                self.Background.Visible = visible
                self.Label.Visible = visible
                self.ValueText.Visible = visible
                self.Track.Visible = visible
                self.Progress.Visible = visible
            end

            table.insert(self.DrawingObjects, {
                Disconnect = function()
                    sliderClickConnection1:Disconnect()
                    sliderClickConnection2:Disconnect()
                    sliderClickConnection3:Disconnect()
                end
            })
            table.insert(self.Elements, Slider)
            
            return Slider
        end

        function Tab:NewToggle(label, callback)
            local State = false
            label = label or "New Toggle"
            callback = callback or function() end

            local Toggle = {}
            local toggleSize = Vector2.new(470, 35)
            local toggleY = self.CurrentY
            self.CurrentY = self.CurrentY + toggleSize.Y + 5
            
            -- Background do toggle
            Toggle.Background = Drawing.new("Square")
            Toggle.Background.Filled = true
            Toggle.Background.Color = Color3.fromRGB(41, 41, 41)
            Toggle.Background.Size = toggleSize
            Toggle.Background.Position = self.Frame.Position + Vector2.new(10, toggleY)
            Toggle.Background.Visible = self.Frame.Visible
            table.insert(DrawingObjects, Toggle.Background)
            table.insert(self.DrawingObjects, Toggle.Background)

            -- Label do toggle
            Toggle.Label = CreateText({
                Text = label,
                Color = Color3.fromRGB(255, 255, 255),
                Size = 14,
                Position = self.Frame.Position + Vector2.new(20, toggleY + 10),
                Visible = self.Frame.Visible
            })
            table.insert(DrawingObjects, Toggle.Label)
            table.insert(self.DrawingObjects, Toggle.Label)

            -- Toggle switch
            Toggle.Switch = Drawing.new("Square")
            Toggle.Switch.Filled = true
            Toggle.Switch.Color = Color3.fromRGB(36, 36, 36)
            Toggle.Switch.Size = Vector2.new(60, 20)
            Toggle.Switch.Position = self.Frame.Position + Vector2.new(toggleSize.X - 50, toggleY + 8)
            Toggle.Switch.Visible = self.Frame.Visible
            table.insert(DrawingObjects, Toggle.Switch)
            table.insert(self.DrawingObjects, Toggle.Switch)

            -- Toggle indicator
            Toggle.Indicator = Drawing.new("Square")
            Toggle.Indicator.Filled = true
            Toggle.Indicator.Color = Color3.fromRGB(255, 81, 81)
            Toggle.Indicator.Size = Vector2.new(25, 20)
            Toggle.Indicator.Position = self.Frame.Position + Vector2.new(toggleSize.X - 25, toggleY + 8)
            Toggle.Indicator.Visible = self.Frame.Visible
            table.insert(DrawingObjects, Toggle.Indicator)
            table.insert(self.DrawingObjects, Toggle.Indicator)

            -- Função para alternar estado
            function Toggle:SetValue(value)
                State = value
                if value then
                    self.Indicator.Color = Color3.fromRGB(2, 255, 108)
                    self.Indicator.Position = self.Frame.Position + Vector2.new(toggleSize.X - 50, toggleY + 8)
                else
                    self.Indicator.Color = Color3.fromRGB(255, 81, 81)
                    self.Indicator.Position = self.Frame.Position + Vector2.new(toggleSize.X - 25, toggleY + 8)
                end
                callback(State)
            end

            -- Evento de clique
            local toggleClickConnection = UserInputService.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 and self.Frame.Visible then
                    local mousePos = input.Position
                    if isPointInRectangle(mousePos, Toggle.Switch.Position, Toggle.Switch.Size) then
                        Toggle:SetValue(not State)
                    end
                end
            end)

            function Toggle:SetVisible(visible)
                self.Background.Visible = visible
                self.Label.Visible = visible
                self.Switch.Visible = visible
                self.Indicator.Visible = visible
            end

            table.insert(self.DrawingObjects, {Disconnect = function() toggleClickConnection:Disconnect() end})
            table.insert(self.Elements, Toggle)
            
            return Toggle
        end

        function Tab:NewBar()
            local Bar = {}
            local barSize = Vector2.new(470, 2)
            local barY = self.CurrentY
            self.CurrentY = self.CurrentY + barSize.Y + 5
            
            Bar.Line = Drawing.new("Square")
            Bar.Line.Filled = true
            Bar.Line.Color = Color3.fromRGB(102, 5, 172)
            Bar.Line.Size = barSize
            Bar.Line.Position = self.Frame.Position + Vector2.new(10, barY)
            Bar.Line.Visible = self.Frame.Visible
            table.insert(DrawingObjects, Bar.Line)
            table.insert(self.DrawingObjects, Bar.Line)

            function Bar:SetVisible(visible)
                self.Line.Visible = visible
            end

            table.insert(self.Elements, Bar)
            
            return Bar
        end

        function Tab:NewKeybind(label, key, callback)
            key = key or "None"
            label = label or "New Keybind"
            callback = callback or function() end

            local listening = false
            local Keybind = {}
            local keybindSize = Vector2.new(470, 35)
            local keybindY = self.CurrentY
            self.CurrentY = self.CurrentY + keybindSize.Y + 5
            
            -- Background do keybind
            Keybind.Background = Drawing.new("Square")
            Keybind.Background.Filled = true
            Keybind.Background.Color = Color3.fromRGB(41, 41, 41)
            Keybind.Background.Size = keybindSize
            Keybind.Background.Position = self.Frame.Position + Vector2.new(10, keybindY)
            Keybind.Background.Visible = self.Frame.Visible
            table.insert(DrawingObjects, Keybind.Background)
            table.insert(self.DrawingObjects, Keybind.Background)

            -- Label do keybind
            Keybind.Label = CreateText({
                Text = label,
                Color = Color3.fromRGB(255, 255, 255),
                Size = 14,
                Position = self.Frame.Position + Vector2.new(20, keybindY + 10),
                Visible = self.Frame.Visible
            })
            table.insert(DrawingObjects, Keybind.Label)
            table.insert(self.DrawingObjects, Keybind.Label)

            -- Botão do keybind
            Keybind.KeyButton = Drawing.new("Square")
            Keybind.KeyButton.Filled = true
            Keybind.KeyButton.Color = Color3.fromRGB(36, 36, 36)
            Keybind.KeyButton.Size = Vector2.new(80, 20)
            Keybind.KeyButton.Position = self.Frame.Position + Vector2.new(keybindSize.X - 70, keybindY + 8)
            Keybind.KeyButton.Visible = self.Frame.Visible
            table.insert(DrawingObjects, Keybind.KeyButton)
            table.insert(self.DrawingObjects, Keybind.KeyButton)

            -- Texto da tecla
            Keybind.KeyText = CreateText({
                Text = key,
                Color = Color3.fromRGB(255, 255, 255),
                Size = 12,
                Position = self.Frame.Position + Vector2.new(keybindSize.X - 65, keybindY + 12),
                Visible = self.Frame.Visible
            })
            table.insert(DrawingObjects, Keybind.KeyText)
            table.insert(self.DrawingObjects, Keybind.KeyText)

            -- Função para iniciar escuta
            function Keybind:StartListening()
                listening = true
                self.KeyText.Text = "..."
                self.KeyButton.Color = Color3.fromRGB(102, 5, 172)
            end

            -- Função para parar escuta
            function Keybind:StopListening(newKey)
                listening = false
                self.KeyText.Text = newKey or key
                self.KeyButton.Color = Color3.fromRGB(36, 36, 36)
                if newKey then
                    key = newKey
                    callback(newKey)
                end
            end

            -- Evento de clique no botão
            local keybindClickConnection = UserInputService.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 and self.Frame.Visible then
                    local mousePos = input.Position
                    if isPointInRectangle(mousePos, Keybind.KeyButton.Position, Keybind.KeyButton.Size) then
                        Keybind:StartListening()
                    end
                end
            end)

            -- Evento de captura de tecla
            local keybindKeyConnection = UserInputService.InputBegan:Connect(function(input)
                if listening then
                    if input.UserInputType == Enum.UserInputType.Keyboard then
                        Keybind:StopListening(input.KeyCode.Name)
                    elseif input.UserInputType == Enum.UserInputType.MouseButton1 then
                        Keybind:StopListening("MouseButton1")
                    elseif input.UserInputType == Enum.UserInputType.MouseButton2 then
                        Keybind:StopListening("MouseButton2")
                    elseif input.UserInputType == Enum.UserInputType.MouseButton3 then
                        Keybind:StopListening("MouseButton3")
                    end
                else
                    -- Executar callback quando a tecla é pressionada
                    if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode.Name == key then
                        callback(key)
                    end
                end
            end)

            function Keybind:SetVisible(visible)
                self.Background.Visible = visible
                self.Label.Visible = visible
                self.KeyButton.Visible = visible
                self.KeyText.Visible = visible
            end

            table.insert(self.DrawingObjects, {
                Disconnect = function()
                    keybindClickConnection:Disconnect()
                    keybindKeyConnection:Disconnect()
                end
            })
            table.insert(self.Elements, Keybind)
            
            return Keybind
        end

        -- Adicionar à lista de tabs
        GUI.Tabs = GUI.Tabs or {}
        table.insert(GUI.Tabs, Tab)

        return Tab
    end

    return GUI
end

return Library
